<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ì¾Œê°ì˜ ë²½ëŒê¹¨ê¸°</title>
    <style>
        body {
            background-color: #2c3e50;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #ecf0f1;
            flex-direction: column;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            touch-action: none; /* ëª¨ë°”ì¼ í„°ì¹˜ ìŠ¤í¬ë¡¤ ë°©ì§€ */
        }
        #gameCanvas {
            background-color: #34495e;
            border: 5px solid #bdc3c7;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        #gameInfo {
            text-align: center;
            margin-top: 15px;
            font-size: 1.2em;
        }
        #startButton {
            padding: 15px 30px;
            font-size: 1.5em;
            cursor: pointer;
            border: none;
            border-radius: 10px;
            background-color: #e74c3c;
            color: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s, background-color 0.2s;
            margin-top: 20px;
        }
        #startButton:hover {
            background-color: #c0392b;
            transform: scale(1.05);
        }
        #messageBox {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(44, 62, 80, 0.9);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            font-size: 2em;
            color: #2ecc71;
            display: none;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.6);
        }
    </style>
</head>
<body>

    <h1 style="color: #2ecc71;">ì¾Œê°ì˜ ë²½ëŒê¹¨ê¸°! ğŸ’¥</h1>
    <canvas id="gameCanvas" width="360" height="640"></canvas>
    <div id="gameInfo">
        <span id="score">ì ìˆ˜: 0</span> | <span id="ballsCount">ê³µ: 1</span>
    </div>
    <button id="startButton">ì‹œì‘í•˜ê¸°</button>
    <div id="messageBox"></div>

    <script>
        // ë³€ìˆ˜ ì„¤ì •
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const startButton = document.getElementById('startButton');
        const messageBox = document.getElementById('messageBox');
        const scoreDisplay = document.getElementById('score');
        const ballsCountDisplay = document.getElementById('ballsCount');

        const isMobile = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

        // ê²Œì„ ìš”ì†Œ
        let balls = [];
        const ballRadius = 6;
        const paddleHeight = 10;
        const paddleWidth = 75;
        let paddleX = (canvas.width - paddleWidth) / 2;

        let bricks = [];
        const brickRowCount = 5;
        const brickColumnCount = 7;
        const brickWidth = 45;
        const brickHeight = 15;
        const brickPadding = 10;
        const brickOffsetTop = 30;
        const brickOffsetLeft = 20;

        let score = 0;
        let gameRunning = false;
        const maxBalls = 32;

        // ë²½ëŒ ìƒì„± í•¨ìˆ˜
        function createBricks() {
            bricks = [];
            for (let c = 0; c < brickColumnCount; c++) {
                bricks[c] = [];
                for (let r = 0; r < brickRowCount; r++) {
                    bricks[c][r] = { x: 0, y: 0, status: 1 };
                }
            }
        }

        // ê³µ ê°ì²´ ìƒì„± í•¨ìˆ˜
        function createBall(x, y, dx, dy) {
            return { x, y, dx, dy };
        }

        // ì´ˆê¸° ê³µ ìƒì„±
        function resetBalls() {
            balls = [createBall(canvas.width / 2, canvas.height - 30, 2, -2)];
        }

        // ëª¨ë“  ê²Œì„ ìš”ì†Œ ê·¸ë¦¬ê¸°
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawBricks();
            drawBalls();
            drawPaddle();
            collisionDetection();
        }

        // ë²½ëŒ ê·¸ë¦¬ê¸°
        function drawBricks() {
            for (let c = 0; c < brickColumnCount; c++) {
                for (let r = 0; r < brickRowCount; r++) {
                    const b = bricks[c][r];
                    if (b.status === 1) {
                        const brickX = (c * (brickWidth + brickPadding)) + brickOffsetLeft;
                        const brickY = (r * (brickHeight + brickPadding)) + brickOffsetTop;
                        b.x = brickX;
                        b.y = brickY;
                        ctx.beginPath();
                        ctx.rect(brickX, brickY, brickWidth, brickHeight);
                        // ë²½ëŒ ìƒ‰ìƒ ë‹¤ì–‘í•˜ê²Œ
                        const hue = (c + r) * 20;
                        ctx.fillStyle = `hsl(${hue}, 70%, 60%)`;
                        ctx.fill();
                        ctx.closePath();
                    }
                }
            }
        }

        // ê³µ ê·¸ë¦¬ê¸°
        function drawBalls() {
            balls.forEach(ball => {
                ctx.beginPath();
                ctx.arc(ball.x, ball.y, ballRadius, 0, Math.PI * 2);
                ctx.fillStyle = "#e74c3c";
                ctx.fill();
                ctx.closePath();
            });
        }

        // íŒ¨ë“¤ ê·¸ë¦¬ê¸°
        function drawPaddle() {
            ctx.beginPath();
            ctx.rect(paddleX, canvas.height - paddleHeight, paddleWidth, paddleHeight);
            ctx.fillStyle = "#2ecc71";
            ctx.fill();
            ctx.closePath();
        }

        // ê³µê³¼ íŒ¨ë“¤, ë²½ ì¶©ëŒ ê°ì§€
        function collisionDetection() {
            // ë²½ëŒê³¼ì˜ ì¶©ëŒ
            balls.forEach(ball => {
                for (let c = 0; c < brickColumnCount; c++) {
                    for (let r = 0; r < brickRowCount; r++) {
                        const b = bricks[c][r];
                        if (b.status === 1) {
                            if (ball.x > b.x && ball.x < b.x + brickWidth && ball.y > b.y && ball.y < b.y + brickHeight) {
                                ball.dy = -ball.dy;
                                b.status = 0;
                                score += 10;
                                scoreDisplay.textContent = `ì ìˆ˜: ${score}`;
                                if (score === brickRowCount * brickColumnCount * 10) {
                                    showMessage("ğŸ‰ ìŠ¹ë¦¬! ğŸ‰");
                                    gameRunning = false;
                                }
                            }
                        }
                    }
                }

                // íŒ¨ë“¤ê³¼ì˜ ì¶©ëŒ
                if (ball.x > paddleX && ball.x < paddleX + paddleWidth && ball.y + ballRadius > canvas.height - paddleHeight) {
                    ball.dy = -ball.dy;
                    // ê³µ 2ë°° ë³µì œ
                    if (balls.length < maxBalls) {
                        const newBall = createBall(ball.x, ball.y, -ball.dx, ball.dy);
                        balls.push(newBall);
                        ballsCountDisplay.textContent = `ê³µ: ${balls.length}`;
                    }
                }
            });
        }

        // ê³µ ì´ë™
        function moveBalls() {
            for (let i = 0; i < balls.length; i++) {
                const ball = balls[i];
                ball.x += ball.dx;
                ball.y += ball.dy;

                // ë²½ê³¼ ì¶©ëŒ
                if (ball.x + ball.dx > canvas.width - ballRadius || ball.x + ball.dx < ballRadius) {
                    ball.dx = -ball.dx;
                }
                if (ball.y + ball.dy < ballRadius) {
                    ball.dy = -ball.dy;
                }
                
                // ê³µì´ ë°”ë‹¥ì— ë–¨ì–´ì¡Œì„ ë•Œ
                if (ball.y + ball.dy > canvas.height - ballRadius) {
                    balls.splice(i, 1);
                    i--; // ë°°ì—´ ìš”ì†Œê°€ ì‚­ì œë˜ì—ˆìœ¼ë¯€ë¡œ ì¸ë±ìŠ¤ ì¡°ì •
                    if (balls.length === 0) {
                        showMessage("ğŸ˜­ ê²Œì„ ì˜¤ë²„ ğŸ˜­");
                        gameRunning = false;
                    }
                }
            }
        }

        // ê²Œì„ ë£¨í”„
        function gameLoop() {
            if (!gameRunning) return;
            draw();
            moveBalls();
            requestAnimationFrame(gameLoop);
        }

        // íŒ¨ë“¤ ì´ë™ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (PC)
        canvas.addEventListener('mousemove', (e) => {
            const relativeX = e.clientX - canvas.offsetLeft;
            if (relativeX > 0 && relativeX < canvas.width) {
                paddleX = relativeX - paddleWidth / 2;
            }
        });

        // íŒ¨ë“¤ ì´ë™ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (Mobile)
        canvas.addEventListener('touchmove', (e) => {
            if (e.touches.length > 0) {
                const relativeX = e.touches[0].clientX - canvas.offsetLeft;
                if (relativeX > 0 && relativeX < canvas.width) {
                    paddleX = relativeX - paddleWidth / 2;
                }
                e.preventDefault(); // ê¸°ë³¸ ìŠ¤í¬ë¡¤ ë™ì‘ ë°©ì§€
            }
        });

        // ë©”ì‹œì§€ ë°•ìŠ¤ í‘œì‹œ
        function showMessage(msg) {
            messageBox.textContent = msg;
            messageBox.style.display = 'block';
            setTimeout(() => {
                messageBox.style.display = 'none';
                startButton.style.display = 'block';
            }, 3000); // 3ì´ˆ í›„ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
        }
        
        // ê²Œì„ ì´ˆê¸°í™” ë° ì‹œì‘
        function startGame() {
            if (gameRunning) return;
            gameRunning = true;
            score = 0;
            scoreDisplay.textContent = `ì ìˆ˜: 0`;
            messageBox.style.display = 'none';
            startButton.style.display = 'none';
            createBricks();
            resetBalls();
            ballsCountDisplay.textContent = `ê³µ: ${balls.length}`;
            gameLoop();
        }

        // ì‹œì‘ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        startButton.addEventListener('click', startGame);

        // í™”ë©´ í„°ì¹˜ë¡œ ê²Œì„ ì‹œì‘ (ëª¨ë°”ì¼)
        if (isMobile) {
            canvas.addEventListener('touchstart', (e) => {
                if (!gameRunning) {
                    startGame();
                    e.preventDefault();
                }
            });
        }
        
        // ì´ˆê¸° í™”ë©´
        createBricks();
        draw();
    </script>
</body>
</html>
